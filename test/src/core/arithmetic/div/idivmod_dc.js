import test from 'ava' ;
import { parse , _zeros , _idivmod_dc , stringify } from '../../../../../src' ;

function macro ( t , dividend , divisor , quotient , remainder ) {

	const B = 10 ;

	const D = parse( 10 , B , dividend ) ;
	const d = parse( 10 , B , divisor ) ;
	const q = _zeros( D.length ) ;

	_idivmod_dc( B , D , 0 , D.length , d , 0 , d.length , q , 0 , q.length ) ;

	t.is(
		quotient ,
		stringify( B , 10 , q , 0 , q.length ) ,
		dividend + ' / ' + divisor + ' = ' + quotient
	) ;

	t.is(
		remainder ,
		stringify( B , 10 , D , 0 , D.length ) ,
		dividend + ' % ' + divisor + ' = ' + remainder
	) ;

} ;

const s = x => x.slice(0,15)+'...' ;
macro.title = ( title , D , d , q , r ) => `${title} ${s(D)} / ${s(d)} = ${s(q)} % ${s(r)}`.trim()


test( macro , '7' , '10' , '0' , '7' ) ;
test( macro , '10' , '7' , '1' , '3' ) ;
test( macro , '7' , '7' , '1' , '0' ) ;
test( macro , '4' , '2' , '2' , '0' ) ;
test( macro , '15' , '3' , '5' , '0' ) ;
test( macro , '16' , '3' , '5' , '1' ) ;

test( macro , '89' , '7' , '12' , '5' ) ;
test( macro , '789' , '77' , '10' , '19' ) ;

test( macro , '120' , '39' , '3' , '3' ) ;
test( macro , '250' , '59' , '4' , '14' ) ;
test( macro , '500' , '59' , '8' , '28' ) ;

test( macro , '400' , '59' , '6' , '46' ) ;

test( macro , '421' , '23' , '18' , '7' ) ;
test( macro , '23' , '421' , '0' , '23' ) ;

test( macro , '3611' , '12' , '300' , '11' ) ;
test( macro , '3899' , '300' , '12' , '299' ) ;

test( macro , '1' , '9999999999999' , '0' , '1' ) ;
test( macro , '9999999999999' , '1' , '9999999999999' , '0' ) ;

test( macro , '9999999999999' , '7777777777777' , '1' , '2222222222222' ) ;

test( macro , '9999999999999' , '777777777777' , '12' , '666666666675' ) ;

test( macro ,
	'27389247928379827398729874923879287398273982739724723937203' ,
	'273892739827938296487254837632' ,
	'99999904873659598945208306076' ,
	'3689578978384602245584885171'
) ;

test( macro ,
	'1000000000000000000000000000000000000000000000000' ,
	'9',
	'111111111111111111111111111111111111111111111111' ,
	'1'
) ;

test( macro , // 2**1000 / 2**625 = 2**(1000-625) = 2**375 remainder 0
	'10715086071862673209484250490600018105614048117055336074437503883703510511249361224931983788156958581275946729175531468251871452856923140435984577574698574803934567774824230985421074605062371141877954182153046474983581941267398767559165543946077062914571196477686542167660429831652624386837205668069376' ,
	'139234637988958594318883410818490335842688858253435056475195084164406590796163250320615014993816265862385324388842602762167013693889631286567769205313788274787963704661873320009853338386432' ,
	'76957043352332967211482500195592995713046365762627825523336510555167425334955489475418488779072100860950445293568',
	'0'
) ;

test( macro , // ( 2**1000 - 1 ) / 2**625 = 2**(1000-625) - 1 = 2**375 - 1 remainder 2**625 - 1
	'10715086071862673209484250490600018105614048117055336074437503883703510511249361224931983788156958581275946729175531468251871452856923140435984577574698574803934567774824230985421074605062371141877954182153046474983581941267398767559165543946077062914571196477686542167660429831652624386837205668069375' ,
	'139234637988958594318883410818490335842688858253435056475195084164406590796163250320615014993816265862385324388842602762167013693889631286567769205313788274787963704661873320009853338386432' ,
	'76957043352332967211482500195592995713046365762627825523336510555167425334955489475418488779072100860950445293567',
	'139234637988958594318883410818490335842688858253435056475195084164406590796163250320615014993816265862385324388842602762167013693889631286567769205313788274787963704661873320009853338386431'
) ;

// covers case A_2 >= B_1 in _dc_div_32

test( macro ,
'7696436905158094003308350373463845221071356045956582063352457594358867621369100939016411590286644205669468206857934835307654199357729258249751557309048431184429670029493281347861350938333001700595191294654520509068223010179372164702642323113738666356044506' ,
'76964369051580940033083503734638452210713560459565820633524575943588676213691009390164115902866442056694682068579348353076541994' ,
'99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999' ,
'34693627301332497342131934919068122240206841807427171571857577644183867508345529899232338913045814221397324391693087019432586500'
) ;

// covers step 5 in _dc_div_32
test( macro ,
	'1190123836642658560840761071891016078481041702312810707143326670670432949517058417889154419284901949562938334619095499692024995029105632277035683758772387607076113677721573438092031886401618806857997945318882041459017486587638738415145269222274916860852961811503745930414299919883445224894613390932992405456336506652332370422683889806726971268976041976718262282347845717718281899447015786618619450921170775291265314853539735292720990307650250834385715075734147351055183226092562902527220319132819529325866121746730165427705936404042523277642451461144852157830864303534189971379917712085036407171089179281934699936793898385939385576944526569405089151310335695539680966312811076081350524871041683154930799815149681250522323804579605756183079035037738322452348416113780582923224911060464135442236143468063778988889971473901480275085979311867478325034256330670764918534857228905789913668905873042428952972071593700143398464600517680624944946179425207441010260237715670339701649513776' ,
	'1090927970419064175550080675198724277143274753776223525603158539909830244388682713830752950995164229747284150070545573064009732417687021717203739744813981583931778400388611812613005309007679898872789143545971827428263215553954228912439677915191023163827729504723604707296655288586122174418324054093283511672862188574424480308268835502789027027725591653731938884499322308018350351735118319204769236686483379598054368410215549331846009986891417148133003574199443258765294469622374806900146809' ,
	'1090927970419064175550080675198724277143274753776223525603158539909830244388682713830752950995164229747284150070545573064009732417687021717203739744813981583931778400388611812613005309007679898872789143545971827428263215553954228912439677915191023163827729504723604707296655288586122174418324054093283511672862188574424480308268835502789027027725591653731938884499322308018350351735118319204769236686483379598054368410215549331846009986891417148133003574199443258765294469622374806900146809' ,
	'11090678776483259438313656736572334813745748301503266300681918322458485231222502492159897624416558312389564843845614287315896631295' ,
) ;

// some large number
test( macro ,
	'164171010688258216356020741663906501410127235530735881272116103087925094171390144280159034536439457734870419127140401667195510331085657185332721089236401193044493457116299768844344303479235489462436380672117015123283299131391904179287678259173308536738761981139958654880852234908448338817289014166774169869251339379828599748492918775437864739032217778051333882990074116246281269364933724892342134504702491040016637557429810893780765197418589477584716543480995722533317862352141459217781316266211186486157019262080414077670264642736018426998113523445732680856144329876972273300703392584997729207197971083945700345494092400147186997307012069454068489589035676979448169848060836924945824197706493306108258511936030341393221586423523264452449403781993352421885094664052270795527632721896121424813173522474674395886155092203404036730748474781710715745446135468098139831824083259647919175273503681561172684624283384438504776503000432241604550454374116320822227191911322123484085063926350606342197146407841178028071147192533942517270553513988142925976090769695456221159699052583533011331652079347093098173086975483539274464023357456484465482927479569437320368592222760278170306076733438801098370797675711274671054970711442158930561684343135774118741594506702833147396758825015850042983343690345185995956235143825771620543546030664562647854656431302644574119873820215595718618624485232422006575550007068883734241454686368856734496265385908809403972494685137741122866896719678053937285818409751670320140501843039224040735870096889596273419106389103662095318937990625980136711988237421962315266686856089505981438440850638067589321141759499017023839596858455548192000140085142294166987063499024792681334843159790936321351919859758669569200541507612099780909705198902176026219872201715422096090343686272984351441594569506778041062663266799342793856313801540959815845788584759033248828248561586450271172777240971795656082001848115815260930521663167480173886064019118572778281516735157779555888167787064432558595410843987446497881666288423233170060413025924629950477303342180149398926073618582715358742250388958231281694757980523791263699450732952325727664209947786063982561775327638504516918570101319391698412388607603742484414748268389669129118026878969735782286841116842656410574647607524418900720328045377993386279808768990376289424757351052369393977137871998119168898493037938756635621557623138404459266598837784229325799838782026060481496865561757031839002257091802876949248392744175669112242088439883248336310597001257385980776961529351198877747193531054956881808332177946751404038228718567911769630971553915410012677600002457982207465176670752102117002773980548089696530972476439694599881281812973217265853884727906535479745854085338851105144585481994156206497436745899944877732531412541279014300324594890623941145509856940982863769834430048120562966797907114102689879364945689860493474954538422367719507882513166051007352994068319251450666676648368200564329382998758875760414259654004977261309988267319806354856051784553990936610634733375984159028722378614984450255386315585631994503350002142910493190254825610707400589976364985748467955131077971641882672895854571236368282811336220769174784720113331269084746524204124263475054112841630933586166195036115696469686075600480420563557567616835633252622327172811002146392754445051182169805284630259703542633955126179520113059629914229833688535925729676778028406897316106101038469119090984567152591962365415039646394591503830797626339246986057077758611413664914168745375266786298141171496573941614387744125843685677063619782918759823106021054037768948440363955500273354237183932878842810678714073209470411156424620797449910432695227953024692353493361947700542269566724108976126',
	'164171010688258216356020741663906501410127235530735881272116103087925094171390144280159034536439457734870419127140401667195510331085657185332721089236401193044493457116299768844344303479235489462436380672117015123283299131391904179287678259173308536738761981139958654880852234908448338817289014166774169869251339379828599748492918775437864739032217778051333882990074116246281269364933724892342134504702491040016637557429810893780765197418589477584716543480995722533317862352141459217781316266211186486157019262080414077670264642736018426998113523445732680856144329876972273300703392584997729207197971083945700345494092400147186997307012069454068489589035676979448169848060836924945824197706493306108258511936030341393221586423523264452449403781993352421885094664052270795527632721896121424813173522474674395886155092203404036730748474781710715745446135468098139831824083259647919175273503681561172684624283384438504776503000432241604550454374116320822227191911322123484085063926350606342197146407841178028071147192533942517270553513988142925976090769695456221159699052583533011331652079347093098173086975483539274464023357456484465482927479569437320368592222760278170306076733438801098370797675711274671054970711442158930561684343135774118741594506702833147396758825015850042983343690345185995956235143825771620543546030664562647854656431302644574119873820215595718618624485232422006575550007068883734241454686368856734496265385908809403972494685137741122866896719678053937285818409751670320140501843039224040735870096889596273419106389103662095318937990625980136711988237421962315266686856089505981438440850638067589321141759499017023839596858455548192000140085142294166987063499024792681334843159790936321351919859758669569200541507612099780909705198902176026219872201715422096090343686272984351441594569506778041062663266799342793856313801540959815845788584759033248828248561586450271172777240971795656082001848115815260930521663167480173886064019118572778281516735157779555888167787064432558595410843987446497881666288423233170060413025924629950477303342180149398926073618582715358742250388958231281694757980523791263699450732952325727664209947786063982561775327638504516918570101319391698412388607603742484414748268389669129118026878969735782286841116842656410574647607524418900720328045377993386279808768990376289424757351052369393977137871998119168898493037938756635621557623138404459266598837784229325799838782026060481496865561757031839002257091802876949248392744175669112242088439883248336310597001257385980776961529351198877747193531054956881808332177946751404038228718567911769630971553915410012677600002457982207465176670752102117002773980548089696530972476439694599881281812973217265853884727906535479745854085338851105144585481994156206497436745899944877732531412541279014300324594890623941145509856940982863769834430048120562966797907114102689879364945689860493474954538422367719507882513166051007352994068319251450666676648368200564329382998758875760414259654004977261309988267319806354856051784553990936610634733375984159028722378614984450255386315585631994503350002142910493190254825610707400589976364985748467955131077971641882672895854571236368282811336220769174784720113331269084746524204124263475054112841630933586166195036115696469686075600480420563557567616835633252622327172811002146392754445051182169805284630259703542633955126179520113059629914229833688535925729676778028406897316106101038469119090984567152591962365415039646394591503830797626339246986057077758611413664914168745375266786298141171496573941614387744125843685677063619782918759823106021054037757857761587472240835040580447360544029064930412569943169729238102162312218687930203068055400275795180972382856696655279408212344831',
	'1',
	'11090678776483259438313656736572334813745748301503266300681918322458485231222502492159897624416558312389564843845614287315896631295',
) ;
